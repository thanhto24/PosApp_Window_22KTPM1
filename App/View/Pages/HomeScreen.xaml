<Page
    x:Class="App.View.Pages.HomeScreen"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:App.View.Pages"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    xmlns:model="using:App.Model"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

    <Grid Padding="20" Background="Wheat">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1*"/>
            <ColumnDefinition Width="4*"/>
            <ColumnDefinition Width="2*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Cột 1: Danh mục sản phẩm -->
        <StackPanel Grid.Column="0" Grid.Row="0" Background="AntiqueWhite" Margin="5">
            <TextBlock Text="Danh mục" Foreground="White" FontSize="20" FontWeight="Bold" Margin="0,0,0,10"/>
            <ListView x:Name="CategoryList" ItemsSource="{x:Bind CategoryViewModel.categories}">
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="model:Category_">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{x:Bind name}" Foreground="Black" FontSize="16" Margin="0,0,10,0"/>
                        </StackPanel>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </StackPanel>

        <!-- Cột 2: Danh sách sản phẩm theo danh mục -->
        <ListView Grid.Column="1" Grid.Row="0" Margin="10" ItemsSource="{x:Bind ProductViewModel.Products}" 
          SelectionMode="None">
            <ListView.ItemsPanel>
                <ItemsPanelTemplate>
                    <ItemsWrapGrid Orientation="Horizontal" HorizontalAlignment="Center" MaximumRowsOrColumns="5"/>
                </ItemsPanelTemplate>
            </ListView.ItemsPanel>
            <ListView.ItemTemplate>
                <DataTemplate x:DataType="model:Product">
                    <Border BorderThickness="1" BorderBrush="Gray" CornerRadius="10" 
                    Background="White" Padding="10" Margin="5" MinHeight="250" MinWidth="180">
                        <StackPanel Orientation="Vertical" HorizontalAlignment="Center">
                            <!-- Hình ảnh sản phẩm -->
                            <Image Source="{x:Bind ImagePath}" Width="120" Height="100" 
                           Stretch="UniformToFill" Margin="0,5"/>
                            <!-- Tên sản phẩm -->
                            <TextBlock Text="{x:Bind Name}" Foreground="Black" FontSize="14" 
                               FontWeight="Bold" HorizontalAlignment="Center"
                               TextWrapping="Wrap" Margin="0,5" Height="20"/>
                            <!-- Giá bán -->
                            <TextBlock Text="{x:Bind CostPrice}" Foreground="DarkGreen" 
                               FontSize="14" HorizontalAlignment="Center" Margin="0,3"/>
                            <!-- VAT -->
                            <TextBlock Text="{x:Bind Vat}" Foreground="DarkRed" 
                               FontSize="14" HorizontalAlignment="Center" Margin="0,3"/>
                            <!-- Nút "+" và "-" -->
                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                <Button Content="-" Width="30" Height="30" FontSize="12"
                                Background="LightGray" Foreground="Black"
                                Click="RemoveButton_Click"
                                DataContext="{Binding}"/>
                                <Button Content="+" Width="30" Height="30" FontSize="12"
                                Background="LightGray" Foreground="Black"
                                Click="AddButton_Click"
                                DataContext="{Binding}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>
        <Grid Grid.Column="2" Grid.Row="0" Background="CornflowerBlue" CornerRadius="10" Padding="2">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Tiêu đề -->
                <RowDefinition Height="*"/>
                <!-- Danh sách sản phẩm -->
                <RowDefinition Height="Auto"/>
                <!-- Tổng tiền và nút -->
            </Grid.RowDefinitions>

            <!-- Tiêu đề -->
            <TextBlock Text="Giỏ hàng:" Foreground="Red" FontSize="20" Margin="5" TextWrapping="Wrap"/>

            <!-- Danh sách sản phẩm -->
            <ListView Grid.Row="1" x:Name="CartListView" ItemsSource="{x:Bind CartViewModel.CartItems}">
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="model:CartItem">
                        <StackPanel Orientation="Vertical" Margin="3">
                            <TextBlock Text="{x:Bind Product.Name}" Foreground="Black" FontSize="14" TextWrapping="Wrap"/>
                            <TextBlock Text="{x:Bind Product.CostPrice}" Foreground="Red" FontSize="14"/>
                            <TextBlock Text="{x:Bind QuantityText}" Foreground="Red" FontSize="14"/>
                        </StackPanel>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>

            <!-- Tổng tiền và nút -->
            <StackPanel Grid.Row="2" Orientation="Vertical" HorizontalAlignment="Center" Margin="5">
                <TextBox x:Name="PromoCodeTextBox" PlaceholderText="Voucher" TextChanged="PromoCodeTextBox_TextChanged"/>
                <TextBox x:Name="CustomerCodeTextBox" PlaceholderText="SĐT tích điểm" TextChanged="CustomerCodeTextBox_TextChanged"/>

                <!-- Tổng tiền -->
                <TextBlock Text="Tổng tiền: " Foreground="Black" FontSize="14"/>
                <TextBlock x:Name="TotalAmountTextBlock" Foreground="Red" FontSize="15" FontWeight="Bold" HorizontalAlignment="Right"/>

                <!-- Số tiền được giảm -->
                <TextBlock Text="Số tiền được giảm:" Foreground="Black" FontSize="14" Margin="5,10,5,0"/>
                <TextBlock x:Name="DiscountAmountTextBlock" Foreground="Green" FontSize="15" FontWeight="Bold" HorizontalAlignment="Right"/>

                <!-- Số tiền phải trả -->
                <TextBlock Text="Số tiền phải trả:" Foreground="Black" FontSize="14" Margin="5,10,5,0"/>
                <TextBlock x:Name="FinalAmountTextBlock" Foreground="Red" FontSize="15" FontWeight="Bold" HorizontalAlignment="Right"/>

                <!-- Nút Xóa và Thanh toán -->
                <StackPanel Orientation="Vertical" HorizontalAlignment="Center" Margin="5" Width="250">
                    <Button Content="Xóa hết" Click="ClearCart_Click" Margin="2" HorizontalAlignment="Stretch"/>
                    <Button Content="Thanh toán" Click="Checkout_Click" Margin="2" HorizontalAlignment="Stretch"/>
                </StackPanel>
            </StackPanel>

        </Grid>



    </Grid>
</Page>
